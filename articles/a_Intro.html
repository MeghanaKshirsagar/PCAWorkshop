<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A short PCA vignette - Wine Example • PCAworkshop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A short PCA vignette - Wine Example">
<meta property="og:description" content="PCAworkshop">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PCAworkshop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a_Intro.html">A short PCA vignette - Wine Example</a>
    </li>
    <li>
      <a href="../articles/b_PCA.html">Principal Component Analysis in R</a>
    </li>
    <li>
      <a href="../articles/c_COA.html">Correspondence Analysis in R</a>
    </li>
    <li>
      <a href="../articles/d_sc_example.html">PCA example: scRNAseq</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/aedin/PCAworkshop">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a_Intro_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A short PCA vignette - Wine Example</h1>
                        <h4 class="author">Aedin Culhane</h4>
            
            <h4 class="date">May 1, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aedin/PCAworkshop/blob/master/vignettes/a_Intro.Rmd"><code>vignettes/a_Intro.Rmd</code></a></small>
      <div class="hidden name"><code>a_Intro.Rmd</code></div>

    </div>

    
    
<div id="r-libraries" class="section level3">
<h3 class="hasAnchor">
<a href="#r-libraries" class="anchor"></a>R libraries</h3>
<p>Install, if necessary, and load necessary libraries and set up R session</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#if (!requireNamespace("BiocManager", quietly = TRUE)) #install.packages("BiocManager")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://juba.github.io/explor/">explor</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Principal component analysis (PCA) provides a method for visualizing the distinguishing patterns or information in a dataset. Additional tutorials will provide a more in-depth review of the method, this is just a short and sweet “taster” vignette.</p>
</div>
<div id="dataset-winetasting-in-bordeaux" class="section level1">
<h1 class="hasAnchor">
<a href="#dataset-winetasting-in-bordeaux" class="anchor"></a>Dataset: Winetasting in Bordeaux</h1>
<p>We will use a very simple example dataset of wine-tasting where 200 judges performed a blind tasting of 5 red wines from Bordeaux, scoring each as boring, mediocre, good or excellent.</p>
<p>The dataset is available in the <code>ade4</code> R package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">bordeaux</span><span class="op">)</span></code></pre></div>
<p>In French wines, table wine has fewer legal restrictions and is cheaper, whereas Cru and Grand Cru wine have more regulation standards and therefore are more expensive.</p>
<div class="figure">
<img src="image/Bordeaux1.png" alt="Figure 1: The bordeaux dataset provides scores from 200 judges in a blind tasting of five different types of red wine from the Bordeaux region of south western parts of France. The judges scored wines as excellent, good, mediocre and boring." width="100%"><p class="caption">
Figure 1: The bordeaux dataset provides scores from 200 judges in a blind tasting of five different types of red wine from the Bordeaux region of south western parts of France. The judges scored wines as excellent, good, mediocre and boring.
</p>
</div>
<p>We can see the data as a cross table, or a tibble</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">bordeaux</span><span class="op">)</span>
<span class="va">bordeaux</span></code></pre></div>
<pre><code>##                    excellent good mediocre boring
## Cru_Bourgeois             45  126       24      5
## Grand_Cru_classe          87   93       19      1
## Vin_de_table               0    0       52    148
## Bordeaux_d_origine        36   68       74     22
## Vin_de_marque              0   30      111     59</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">&lt;-</span><span class="va">bordeaux</span> <span class="op">%&gt;%</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"Wine"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">.</span>,variable.name<span class="op">=</span><span class="st">"Judge_Score"</span>,
                 value.name<span class="op">=</span><span class="st">"Number"</span><span class="op">)</span>
<span class="va">df</span></code></pre></div>
<pre><code>##                  Wine Judge_Score Number
## 1       Cru_Bourgeois   excellent     45
## 2    Grand_Cru_classe   excellent     87
## 3        Vin_de_table   excellent      0
## 4  Bordeaux_d_origine   excellent     36
## 5       Vin_de_marque   excellent      0
## 6       Cru_Bourgeois        good    126
## 7    Grand_Cru_classe        good     93
## 8        Vin_de_table        good      0
## 9  Bordeaux_d_origine        good     68
## 10      Vin_de_marque        good     30
## 11      Cru_Bourgeois    mediocre     24
## 12   Grand_Cru_classe    mediocre     19
## 13       Vin_de_table    mediocre     52
## 14 Bordeaux_d_origine    mediocre     74
## 15      Vin_de_marque    mediocre    111
## 16      Cru_Bourgeois      boring      5
## 17   Grand_Cru_classe      boring      1
## 18       Vin_de_table      boring    148
## 19 Bordeaux_d_origine      boring     22
## 20      Vin_de_marque      boring     59</code></pre>
<p>Data visualization is important and always a good first step with any dataset, even simple ones. We visualize this data, with a simple barplot, to see the distribution of excellent, good, mediocre and boring scores for each wine. The Grand Cru Classe recieved more “excellent” scores than the Vin_de_table (table wine).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#devtools::install_github("gadenbuie/ggpomological")</span>
<span class="co">#install.packages("magick")</span>

<span class="va">p</span><span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>,
           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Judge_Score</span>, <span class="va">Number</span>, fill<span class="op">=</span><span class="va">Judge_Score</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>,stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Wine</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">scale_fill_pomological</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">theme_pomological</span><span class="op">(</span><span class="st">"Homemade Apple"</span>, <span class="fl">12</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
          legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span>

 <span class="fu">paint_pomological</span><span class="op">(</span><span class="va">p</span>,res <span class="op">=</span> <span class="fl">110</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_write</a></span><span class="op">(</span><span class="st">"barplot-painted.png"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="image/barplot-painted.png" alt="Figure: Visualizing the bordeaux dataset using ggplot and ggtheme pomological" width="100%"><p class="caption">
Figure: Visualizing the bordeaux dataset using ggplot and ggtheme pomological
</p>
</div>
<p>To make it visually interesting we used the <code>ggpomological</code> graphics ggtheme, to display these wine data. The pomology ggtheme and palette evokes the style and colors of old watercolor prints of pomology; a branch of botany that studies and cultivates fruit <a href="https://www.garrickadenbuie.com/project/ggpomological">ggpomological</a>.</p>
</div>
<div id="running-pca" class="section level1">
<h1 class="hasAnchor">
<a href="#running-pca" class="anchor"></a>Running PCA</h1>
<p>We will show two quick approaches to run PCA as seen in Figure 3.</p>
<div class="figure">
<img src="image/bordeaux_pca.png" alt="Figure 3: Overview of a PCA of bordeaux dataset" width="100%"><p class="caption">
Figure 3: Overview of a PCA of bordeaux dataset
</p>
</div>
<ol style="list-style-type: decimal">
<li>We will scale the data with <code>center=TRUE, scale=TRUE</code>,</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bordeauxS</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">bordeaux</span>,center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bordeauxS</span><span class="op">)</span></code></pre></div>
<pre><code>##                     excellent       good   mediocre     boring
## Cru_Bourgeois       0.3148138  1.2550661 -0.8434205 -0.6893123
## Grand_Cru_classe    1.4746543  0.5934498 -0.9752049 -0.7549611
## Vin_de_table       -0.9278724 -1.2711053 -0.1054276  1.6576321
## Bordeaux_d_origine  0.0662766  0.0922253  0.4744240 -0.4103050
## Vin_de_marque      -0.9278724 -0.6696359  1.4496290  0.1969464</code></pre>
<p>and apply singular value decomposition (SVD) to the z-score scaled data. This will generates 3 matrices, U, D, V.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">bordeauxS</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 3
##  $ d: num [1:4] 3.50 1.71 9.00e-01 5.36e-17
##  $ u: num [1:5, 1:4] -0.4404 -0.5408 0.5595 -0.0253 0.4471 ...
##  $ v: num [1:4, 1:4] -0.535 -0.539 0.422 0.496 0.13 ...</code></pre>
<p>where <span class="math display">\[X = U D V'\]</span></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span><span class="op">$</span><span class="va">u</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">d</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">v</span><span class="op">)</span> <span class="co">#  X = U D V'</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]
## [1,]  0.3148138  1.2550661 -0.8434205 -0.6893123
## [2,]  1.4746543  0.5934498 -0.9752049 -0.7549611
## [3,] -0.9278724 -1.2711053 -0.1054276  1.6576321
## [4,]  0.0662766  0.0922253  0.4744240 -0.4103050
## [5,] -0.9278724 -0.6696359  1.4496290  0.1969464</code></pre>
<pre><code>D is a diagonal matrix, with the singular values.

U and V contain the left and right singular vectors, which allows us to extract the scores of the rows and columns in the reduced space. </code></pre>
<p>The diagonal matrix <span class="math display">\[diag(s$d)\]</span> contains the singular values.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>##         [,1]     [,2]      [,3]         [,4]
## [1,] 3.50159 0.000000 0.0000000 0.000000e+00
## [2,] 0.00000 1.711166 0.0000000 0.000000e+00
## [3,] 0.00000 0.000000 0.9004307 0.000000e+00
## [4,] 0.00000 0.000000 0.0000000 5.364347e-17</code></pre>
<p>The singular values <code>s$d</code> are square roots of eigenvalues which tell how much variance is captured by each component.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">d</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">d</span><span class="op">^</span><span class="fl">2</span> <span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 76.63 18.30  5.07  0.00</code></pre>
<p>The first component (PC1, horizontal) captured almost 77% of the variance or information in the data, and shows that boring/medicore wines were distinct from good/excellent, with Vin de table (Table Wine) and Vin de marque (Brand Wine) associated with the former descriptions. Regional Bordeaux wine (Bordeaux d’origine) was close to the origin, with Cru and Grand Cru wines associated with good/excellent terms</p>
<p>The second component represented 18% of the variance, and mostly distinguished boring from medicore wine. There was little distinction between good and excellent on PC 2.</p>
<ol start="2" style="list-style-type: decimal">
<li>We can perform the same calculation by as calling a PCA function, for example if we call PCA is the R package <code>ade4</code>.</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bordeaux.pca</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">bordeaux</span>, scan <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bordeaux.pca</span><span class="op">)</span></code></pre></div>
<pre><code>## Class: pca dudi
## Call: dudi.pca(df = bordeaux, scannf = FALSE)
## 
## Total inertia: 4
## 
## Eigenvalues:
##     Ax1     Ax2     Ax3 
##  3.0653  0.7320  0.2027 
## 
## Projected inertia (%):
##     Ax1     Ax2     Ax3 
##  76.632  18.301   5.067 
## 
## Cumulative projected inertia (%):
##     Ax1   Ax1:2   Ax1:3 
##   76.63   94.93  100.00</code></pre>
<p>The first component (horizontal), which captures most of the information in the dataset, distinguished Vin de table and Vin de marque from the other wines. Whilst Vin de table and Vin de marque were associated with the scores “boring” and “mediocre”. The Grand Cru and Cru wines were “excellent” and “good”</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/scatter.html">scatter</a></span><span class="op">(</span> <span class="va">bordeaux.pca</span><span class="op">)</span></code></pre></div>
<p><img src="a_Intro_files/figure-html/unnamed-chunk-11-1.png" width="1000"></p>
<p>We can see the relationship between each variable and the first component, by plotting the score of the first component against the orginal data.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/score.html">score</a></span><span class="op">(</span><span class="va">bordeaux.pca</span><span class="op">)</span></code></pre></div>
<p><img src="a_Intro_files/figure-html/unnamed-chunk-12-1.png" width="1000"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot(bordeaux.pca$l1[,1], bordeaux$excellent)</span></code></pre></div>
<p>We will learn more about the relationship between SVD and PCA, the different R packages that run PCA, in the second vignette Principal Component Analysis in R. We will apply PCA to genomics data in the 4th vignette of the workshop; PCA example: scRNAseq.</p>
</div>
<div id="a-few-resources-for-visualization-of-results-explor-pcaexplorer" class="section level1">
<h1 class="hasAnchor">
<a href="#a-few-resources-for-visualization-of-results-explor-pcaexplorer" class="anchor"></a>A few resources for visualization of Results; Explor, pcaExplorer</h1>
<div id="explor" class="section level2">
<h2 class="hasAnchor">
<a href="#explor" class="anchor"></a>Explor</h2>
<p>Julien Barnier’s package <code>explor</code> provides a nice shiny interface to explore matrix factorization results including PCA, Correspondence analysis, or Multiple correspondence analysis and other dimension reduction methods available in R packages <code>ade4</code>, <code>vegan</code>, <code>FactoMineR</code>, <code>GDATools</code>, <code>MASS</code>, <code>stats</code> (<code>prcomp</code> or <code>princomp</code>)</p>
<div class="figure">
<img src="image/explor.png" alt="Explor" width="70%"><p class="caption">
Explor
</p>
</div>
</div>
<div id="pcaexplorer" class="section level2">
<h2 class="hasAnchor">
<a href="#pcaexplorer" class="anchor"></a>pcaExplorer</h2>
<p>Federico Marini and Harald Binder have create a Bioconductor package called <code>pcaExplorer</code></p>
<div class="figure">
<img src="image/pcaExplor.png" alt="PCA of bordeaux dataset" width="70%"><p class="caption">
PCA of bordeaux dataset
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] reshape2_1.4.4 tibble_3.1.3   ade4_1.7-17    explor_0.3.9   ggplot2_3.3.5 
## [6] dplyr_1.0.7    knitr_1.33    
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.7         tidyr_1.1.3        assertthat_0.2.1   rprojroot_2.0.2   
##  [5] digest_0.6.27      utf8_1.2.2         mime_0.11          plyr_1.8.6        
##  [9] R6_2.5.0           ellipse_0.4.2      evaluate_0.14      highr_0.9         
## [13] pillar_1.6.2       rlang_0.4.11       jquerylib_0.1.4    rmarkdown_2.9     
## [17] pkgdown_1.6.1      textshaping_0.3.5  desc_1.3.0         stringr_1.4.0     
## [21] htmlwidgets_1.5.3  munsell_0.5.0      shiny_1.6.0        compiler_4.1.0    
## [25] httpuv_1.6.1       xfun_0.24          pkgconfig_2.0.3    systemfonts_1.0.2 
## [29] htmltools_0.5.1.1  tidyselect_1.1.1   fansi_0.5.0        crayon_1.4.1      
## [33] withr_2.4.2        later_1.2.0        MASS_7.3-54        grid_4.1.0        
## [37] jsonlite_1.7.2     xtable_1.8-4       gtable_0.3.0       lifecycle_1.0.0   
## [41] DBI_1.1.1          magrittr_2.0.1     formatR_1.11       scales_1.1.1      
## [45] stringi_1.7.3      cachem_1.0.5       fs_1.5.0           promises_1.2.0.1  
## [49] bslib_0.2.5.1      ellipsis_0.3.2     ragg_1.1.3         generics_0.1.0    
## [53] vctrs_0.3.8        scatterD3_1.0.0    RColorBrewer_1.1-2 tools_4.1.0       
## [57] glue_1.4.2         purrr_0.3.4        fastmap_1.1.0      yaml_2.2.1        
## [61] colorspace_2.0-2   memoise_2.0.0      sass_0.4.0</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Aedin Culhane, Lauren Hsu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
