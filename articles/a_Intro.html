<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A short PCA vignette - Wine Example • PCAworkshop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A short PCA vignette - Wine Example">
<meta property="og:description" content="PCAworkshop">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PCAworkshop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a_Intro.html">A short PCA vignette - Wine Example</a>
    </li>
    <li>
      <a href="../articles/b_PCA.html">Principal Component Analysis in R</a>
    </li>
    <li>
      <a href="../articles/c_COA.html">Correspondence Analysis in R</a>
    </li>
    <li>
      <a href="../articles/d_sc_example.html">PCA example: scRNAseq</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/aedin/PCAworkshop">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a_Intro_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A short PCA vignette - Wine Example</h1>
                        <h4 class="author">Aedin Culhane</h4>
            
            <h4 class="date">May 1, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aedin/PCAworkshop/blob/master/vignettes/a_Intro.Rmd"><code>vignettes/a_Intro.Rmd</code></a></small>
      <div class="hidden name"><code>a_Intro.Rmd</code></div>

    </div>

    
    
<div id="necessary-r-libraries" class="section level3">
<h3 class="hasAnchor">
<a href="#necessary-r-libraries" class="anchor"></a>Necessary R libraries</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># Install, if necessary, and load necessary libraries and set up R session</span>
<span class="co">#if (!requireNamespace("BiocManager", quietly = TRUE)) #install.packages("BiocManager")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">explor</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ade4</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tibble</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">reshape2</span>)</pre></body></html></div>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Principal component analysis (PCA) provides a method for visualizing the distinguishing patterns or information in a dataset. Additional tutorials will provide a more in-depth review of the method, this is just a short and sweet “taster” vignette.</p>
</div>
<div id="dataset-winetasting-in-bordeaux" class="section level1">
<h1 class="hasAnchor">
<a href="#dataset-winetasting-in-bordeaux" class="anchor"></a>Dataset: Winetasting in Bordeaux</h1>
<p>This is a very simple example dataset: 200 judges performed a blind tasting of 5 red wines from Bordeaux, scoring each as boring, mediocre, good or excellent.</p>
<p>The dataset is available in the <code>ade4</code> R package:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">bordeaux</span>)</pre></body></html></div>
<p>In French wines, table wine has fewer legal restrictions and is cheaper, whereas Cru and Grand Cru wine have tight rules and are more expensive.</p>
<div class="figure">
<img src="image/Bordeaux1.png" alt="A simple dataset example" width="100%"><p class="caption">
A simple dataset example
</p>
</div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">bordeaux</span>)
<span class="no">df</span><span class="kw">&lt;-</span><span class="no">bordeaux</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">tibble</span><span class="kw ns">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span>(<span class="kw">var</span><span class="kw">=</span><span class="st">"Wine"</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">reshape2</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span>(<span class="no">.</span>,<span class="kw">variable.name</span><span class="kw">=</span><span class="st">"Judge_Score"</span>,
                 <span class="kw">value.name</span><span class="kw">=</span><span class="st">"Number"</span>)</pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/score.html">score</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.coa.html">dudi.coa</a></span>(<span class="no">bordeaux</span>, <span class="kw">scan</span> <span class="kw">=</span> <span class="fl">FALSE</span>))</pre></body></html></div>
<p><img src="fig/unnamed-chunk-3-1.png" width="1000"></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/score.html">score</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span>(<span class="no">bordeaux</span>, <span class="kw">scan</span> <span class="kw">=</span> <span class="fl">FALSE</span>))</pre></body></html></div>
<p><img src="fig/unnamed-chunk-3-2.png" width="1000"></p>
<div id="a-tangent---fun-graphics-with-ggpomological" class="section level2">
<h2 class="hasAnchor">
<a href="#a-tangent---fun-graphics-with-ggpomological" class="anchor"></a>A tangent - Fun graphics with <code>ggpomological</code>
</h2>
<p>Completely unrelated to PCA, but the <code>ggpomological</code> ggtheme is a fun one for displaying these wine data. Pomology is a branch of botany that studies and cultivates fruit and <a href="https://www.garrickadenbuie.com/project/ggpomological">ggpomological</a> is a ggtheme and palette that evokes the style and colors of old watercolor prints of pomology.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co">#devtools::install_github("gadenbuie/ggpomological")</span>
<span class="co">#install.packages("magick")</span>

<span class="no">p</span><span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">df</span>,
           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">Judge_Score</span>, <span class="no">Number</span>, <span class="kw">fill</span><span class="kw">=</span><span class="no">Judge_Score</span>))+
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">"black"</span>,<span class="kw">stat</span> <span class="kw">=</span> <span class="st">"identity"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(~<span class="no">Wine</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>)+
    <span class="fu">scale_fill_pomological</span>()+
    <span class="fu">theme_pomological</span>(<span class="st">"Homemade Apple"</span>, <span class="fl">12</span>)+
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
          <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"bottom"</span>,
          <span class="kw">legend.key</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="st">"black"</span>))

 <span class="fu">paint_pomological</span>(<span class="no">p</span>,<span class="kw">res</span> <span class="kw">=</span> <span class="fl">110</span>) <span class="kw">%&gt;%</span>
   <span class="kw pkg">magick</span><span class="kw ns">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_write</a></span>(<span class="st">"barplot-painted.png"</span>)</pre></body></html></div>
<div class="figure">
<img src="image/barplot-painted.png" alt="pomological ggplot bordeaux dataset" width="100%"><p class="caption">
pomological ggplot bordeaux dataset
</p>
</div>
</div>
</div>
<div id="running-pca-or-svd" class="section level1">
<h1 class="hasAnchor">
<a href="#running-pca-or-svd" class="anchor"></a>Running PCA or SVD</h1>
<p>To run a PCA, we will scale the data with <code>center=TRUE, scale=TRUE</code> and run singular value decomposition (SVD). This generates 3 matrices, U, D, V. D is a diagonal matrix, with the eigenvalues. U and V are the left and right singular values, which include the scores of the rows and columns in the reduced space.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">bordeauxS</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(<span class="no">bordeaux</span>,<span class="kw">center</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">s</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span>(<span class="no">bordeauxS</span>)
<span class="no">s</span>$<span class="no">u</span> <span class="kw">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">s</span>$<span class="no">d</span>) <span class="kw">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">s</span>$<span class="no">v</span>) <span class="co">#  X = U D V'</span></pre></body></html></div>
<pre><code>           [,1]       [,2]       [,3]       [,4]
[1,]  0.3148138  1.2550661 -0.8434205 -0.6893123
[2,]  1.4746543  0.5934498 -0.9752049 -0.7549611
[3,] -0.9278724 -1.2711053 -0.1054276  1.6576321
[4,]  0.0662766  0.0922253  0.4744240 -0.4103050
[5,] -0.9278724 -0.6696359  1.4496290  0.1969464</code></pre>
<p>The first component (PC1, horizontal) captured almost 77% of the variance or information in the data, and shows that boring/medicore wines were distinct from good/excellent, with Vin de table (Table Wine) and Vin de marque (Brand Wine) associated with the former descriptions. Regional Bordeaux wine (Bordeaux d’origine) was close to the origin, with Cru and Grand Cru wines associated with good/excellent terms</p>
<p>The second component represented 18% of the variance, and mostly distinguished boring from medicore wine. There was little distinction between good and excellent on PC 2.</p>
<div class="figure">
<img src="image/bordeaux_pca.png" alt="PCA of bordeaux dataset" width="100%"><p class="caption">
PCA of bordeaux dataset
</p>
</div>
</div>
<div id="visualization-of-results-explor-pcaexplorer" class="section level1">
<h1 class="hasAnchor">
<a href="#visualization-of-results-explor-pcaexplorer" class="anchor"></a>Visualization of Results; Explor, pcaExplorer</h1>
<div id="explor" class="section level2">
<h2 class="hasAnchor">
<a href="#explor" class="anchor"></a>Explor</h2>
<p>Julien Barnier’s package <code>explor</code> provides a nice shiny interface to explore matrix factorization results including PCA, Correspondence analysis, or Multiple correspondence analysis and other dimension reduction methods available in R packages <code>ade4</code>, <code>vegan</code>, <code>FactoMineR</code>, <code>GDATools</code>, <code>MASS</code>, <code>stats</code> (<code>prcomp</code> or <code>princomp</code>)</p>
<div class="figure">
<img src="image/explor.png" alt="Explor" width="70%"><p class="caption">
Explor
</p>
</div>
</div>
<div id="pcaexplorer" class="section level2">
<h2 class="hasAnchor">
<a href="#pcaexplorer" class="anchor"></a>pcaExplorer</h2>
<p>Federico Marini and Harald Binder have create a Bioconductor package called <code>pcaExplorer</code></p>
<div class="figure">
<img src="image/pcaExplor.png" alt="PCA of bordeaux dataset" width="70%"><p class="caption">
PCA of bordeaux dataset
</p>
</div>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</pre></body></html></div>
<pre><code>R version 4.0.0 (2020-04-24)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 18.04.4 LTS

Matrix products: default
BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] reshape2_1.4.4 tibble_3.0.3   ade4_1.7-15    explor_0.3.6   ggplot2_3.3.2 
[6] dplyr_1.0.0    knitr_1.29    

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.5         plyr_1.8.6         highr_0.8          formatR_1.7       
 [5] RColorBrewer_1.1-2 later_1.1.0.1      compiler_4.0.0     pillar_1.4.6      
 [9] scatterD3_0.9.1    tools_4.0.0        digest_0.6.25      evaluate_0.14     
[13] memoise_1.1.0      lifecycle_0.2.0    gtable_0.3.0       pkgconfig_2.0.3   
[17] rlang_0.4.7        shiny_1.5.0        yaml_2.2.1         pkgdown_1.5.1     
[21] xfun_0.15          fastmap_1.0.1      withr_2.2.0        stringr_1.4.0     
[25] generics_0.0.2     desc_1.2.0         fs_1.4.2           vctrs_0.3.2       
[29] htmlwidgets_1.5.1  rprojroot_1.3-2    grid_4.0.0         tidyselect_1.1.0  
[33] glue_1.4.1         ellipse_0.4.2      R6_2.4.1           rmarkdown_2.3     
[37] tidyr_1.1.0        purrr_0.3.4        magrittr_1.5       promises_1.1.1    
[41] backports_1.1.8    scales_1.1.1       ellipsis_0.3.1     htmltools_0.5.0   
[45] MASS_7.3-51.6      assertthat_0.2.1   xtable_1.8-4       mime_0.9          
[49] colorspace_1.4-1   httpuv_1.5.4       stringi_1.4.6      munsell_0.5.0     
[53] crayon_1.3.4      </code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Aedin Culhane, Lauren Hsu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
